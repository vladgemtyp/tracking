<?php
/**
 * Template for displaying Stagem Charts
 *
 * @var $block \Stagem\OrderMapTracking\Block\GoogleMap
 */
?>
<?php
$_apikey = 'AIzaSyAXLGek78kcqWSls6NFcOLmy9jO4WV-Cpw';

if ($_apikey) {
    $_gmapsSrc = "//maps.googleapis.com/maps/api/js?key=" . $_apikey;
} else {
    $_gmapsSrc = "//maps.googleapis.com/maps/api/js?v=3.17";
}
?>

<div class="created-at">Created At : <span><?= $block->getCreatedAt(); ?></span></div>

<div class="mass-status-wrapper">
    <p class="mass-status-title">Select the status you want to set for selected orders:</p>

    <div class="selectmenu"
         data-mage-init='{
            "collapsible":{
                "collapsible": true,
                "openedState": "active"
            }}'
    >
        <div class="selectmenu-value">
            <input type="text" value="Select status" name="label">
            <input type="text" name="code" style="display: none;">
        </div>
        <button class="action selectmenu-toggle"
                type="button"
                data-role="title">
            <span>Select</span>
        </button>
        <div class="selectmenu-items" data-role="content">
            <ul>
                <?php foreach($block->getOrderStatusList() as $statusCode => $statusLabel) : ?>
                    <li>
                        <div class="selectmenu-item" >
                            <div class="selectmenu-item-action" data-status-code="<?= $statusCode; ?>">
                                <?= $statusLabel; ?>
                            </div>

                        </div>
                    </li>
                <?php endforeach; ?>
            </ul>
        </div>
    </div>

    <button type="button" class="mass-action">Set status</button>
</div>

<div class="tracking">
    <div class="order-input-wrapper">
        <input type="text" class="order-input" placeholder="Enter order number">
    </div>
    <div class="tracking_addresses">
        <?php $i = 0; ?>
        <?php foreach ($block->json->unserialize($block->getAddresses()) as $address) : ?>
            <? if ($address['status'] === $block->getOrderStorehouseStatus()) : ?>
                <div class="address"
                     data-id="<?= $i++; ?>"
                     data-order="<?= $address['order']; ?>"
                     data-status="<?= $address['status'] ?>"
                >
                    <div class="label">#<?= $i; ?></div>
                    <div><?= $address['customer']; ?></div>
                    <div>Address: <?= $address['address']; ?></div>
                </div>
            <? else : ?>
                <?php $isDelivered = $address['status'] === $block->getOrderDeliveredStatus(); ?>
                <div class="address"
                     data-id="<?= $i++; ?>"
                     data-order="<?= $address['order']; ?>"
                     data-status="<?= $address['status'] ?>"
                >
                    <div class="label">
                        <input type="checkbox" name="order[]" value="<?= $address['order']; ?>">
                        #<?= $i; ?>
                    </div>
                    <div>Customer: <?= $address['customer']; ?></div>
                    <div>Address: <?= $address['address']; ?></div>
                    <div>Order: <?= $address['order']; ?></div>
                    <? if (array_key_exists('status', $address)): ?>
                        <div>Status: <?= $address['status']; ?></div>
                    <? endif; ?>
                </div>
            <? endif; ?>

        <?php endforeach; ?>
    </div>
    <div id="tracking_map"></div>
</div>

<svg display="none" id="svg8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 508.25 207.71"><defs><style>.cls-1{fill:#e60000;}.cls-2{fill:red;stroke:red;stroke-width:0.75px;}.cls-10,.cls-2,.cls-3,.cls-4,.cls-7,.cls-8,.cls-9{stroke-miterlimit:11.34;}.cls-13,.cls-3,.cls-5{fill:#d3d3d3;}.cls-10,.cls-12,.cls-13,.cls-3,.cls-4,.cls-7,.cls-8,.cls-9{stroke:#000;}.cls-3,.cls-4{stroke-width:0.43px;}.cls-4{fill:#231f20;}.cls-6{fill:gray;}.cls-7{fill:#fff;stroke-width:0.51px;}.cls-8{fill:#999;}.cls-10,.cls-8,.cls-9{stroke-width:1.76px;}.cls-10{fill:#666;}.cls-11{fill:#696969;}.cls-12,.cls-13{stroke-miterlimit:9.92;}.cls-12{stroke-width:0.99px;}.cls-13{stroke-linecap:round;stroke-width:0.1px;}</style></defs><path id="path4948" class="cls-1" d="M50,.84c-16.42,0-17.56,0-19.62.86a15.44,15.44,0,0,1-6.17.87c-7,0-11,1.65-13,5.44-.44.81-1,1.48-1.31,1.48-.73,0-1,.94-.47,1.9.28.54.26,2.07-.06,4.53-.26,2-.67,6.42-.92,9.74s-.63,8-.86,10.35C7,41.46,6,55.42,5.42,64.69,5.17,68.6,4.65,76,4.26,81.07c-.57,7.4-.72,15.62-.74,40.54,0,17.2.12,32.94.31,35l.34,3.72-1.69.27a4.56,4.56,0,0,0-2.18.86c-.67.81-.13,8,.62,8.32a.83.83,0,0,1,.32,1c-.46,1.79,3.4,6.06,5.49,6.06A14.91,14.91,0,0,1,10,178a36.09,36.09,0,0,0,7.87,1.94c7,1.07,7.81,1.07,7.81-.05,0-.85.16-.87,5.93-.54,3.27.18,12,.33,19.3.33,12.69,0,13.43,0,14.55-.86s2.29-3.63,3.34-8.73c.55-2.66.57-2.7,2-2.7,1.66,0,1.68.08,1,4.23-.72,4.47.4,11.06,2.74,16.1a34.89,34.89,0,0,0,10.67,13l3,2.09H90a31.44,31.44,0,0,0,28.37-.22H120l2.63-1.73c6.37-4.19,12-13.22,13.2-21.34a28.73,28.73,0,0,0,.41-5.71l-.22-1.62h3.86l.26,1.95c.39,2.81,1.4,4.48,3.22,5.3,1.46.66,5.11.72,42.88.64l41.3-.08v4.27l29.86-.11,29.78-.11.14-2,.13-2h98.3l.45-1.19a25.57,25.57,0,0,0,.86-3.34c.66-3.5.66-3.51,2.33-3.31,1.34.15,1.51.32,1.51,1.42,0,.69.3,3.24.66,5.66,1.32,8.76,6.43,17.17,13.09,21.53l3.18,2.09h1.6a31.53,31.53,0,0,0,28.62-.29,8.92,8.92,0,0,0,1.46-.15c4.32-1.73,10.41-8.28,13.13-14.1,1.94-4.14,3.52-11.41,3.08-14.13l-.25-1.51h4.29l.54,2.4c.4,1.8.77,2.48,1.5,2.76,1.59.6,21.27,1.07,21.93.53a24.17,24.17,0,0,1,4.87-1.38c6.12-1.28,14-4.76,16.07-7.11a9.91,9.91,0,0,1,2.28-2c.73-.28,1.25-4.26,1.25-9.62,0-2.33-.12-2.72-.87-2.92s-.86-.58-.86-2.82.12-2.64.89-2.88c1.43-.46.78-1.59-1.32-2.29-1.07-.36-1.7-.73-1.4-.83.84-.28.63-2-.35-2.93l-.89-.81,1-.34c.84-.32.91-.57.67-2.39a12.56,12.56,0,0,1,.35-4.36,5.48,5.48,0,0,0,.24-3,55.76,55.76,0,0,1-2.82-6.67c-.45-2.18-3.58-6.84-6.81-10.12-4.41-4.49-17.84-14.76-30.26-23.14-9.06-6.11-12.72-9-12.72-9.89a4.54,4.54,0,0,0-1.16-1.64A3.38,3.38,0,0,0,449,80c-1.68,0-1.92-.17-4-2.8-2.38-3-3.46-3.43-4.51-1.93-.58.82-1,.47-7.66-6.8-12.09-13.13-25.14-26.13-38.35-38.19-15.76-14.39-15.36-14.06-20.77-17a67.69,67.69,0,0,0-22.14-7.53c-17.07-3-26.23-3.41-71.34-3.34H227c-7.17,0-15.86,0-19.3-.14C199.5,2,153.14,2,145.4,2.27c-3.32.09-19.23.14-35.36.1s-31.26,0-33.63.16c-3.71.19-4.64.09-6.6-.68C67.63,1,66.81.92,50.1.92Z" transform="translate(0 0)"/><path id="path5706" class="cls-2" d="M5.66,110.62h10c-3-7.87-9.46-12.16-10-13.08Z" transform="translate(0 0)"/><path id="path5431" class="cls-3" d="M335.29,27.63c2.58,0,5.9,0,10.22.13,14.51.27,23.37.95,24.21,1.86.18.2,1.52,11.31,3,24.7l2.68,24.33-1.83,1.86a24.47,24.47,0,0,1-1.94,1.87L357.38,81.1c-14.37-1.3-21.75-2.55-24.59-4.18s-3.85-4.53-5.08-13.3c-1.3-9.25-2.39-19.92-2.66-26.13-.24-5.61-.18-6.44.51-7.62,1-1.72,2-2.23,9.77-2.24Z" transform="translate(0 0)"/><path id="path5433" class="cls-3" d="M372.67,31c.29,0,.87.42,2.11,1.43,2.7,2.19,26.85,27.46,26.85,28.08a4,4,0,0,0,1,1.55c.94,1,1.13,1.79,1.73,7.51.7,6.69.87,11.92.39,11.92a10.82,10.82,0,0,1-2-1.42c-2.68-2.14-5.33-3.76-6.15-3.76a3.38,3.38,0,0,0-1.73.93l-1,.94-2.77-2.66c-1.53-1.46-3.12-2.66-3.54-2.66s.93-1.72,4.06-4.89a41.88,41.88,0,0,0,4.83-5.39,3.74,3.74,0,0,0-2.24-2.23c-.28,0-4.25,3.72-8.81,8.26l-8.3,8.26-.24-1.47c-.54-3.25-4.61-43.17-4.48-44,0-.28.11-.44.28-.44Z" transform="translate(0 0)"/><path id="path5435" class="cls-4" d="M386.2,73.87a2.46,2.46,0,0,1,.6.07,13.69,13.69,0,0,1,3.82,2.65L393.18,79l-2.35,2.4-2.34,2.4-3.67-.27c-2-.14-4.49-.38-5.5-.52s-1.83-.45-1.83-.7a32.5,32.5,0,0,1,4-4.53c3-3,3.85-3.82,4.68-3.86Z" transform="translate(0 0)"/><path id="path5437" class="cls-4" d="M399.66,79.38c5.25,3.65,7.2,5.91,4.67,5.43-.65-.13-4-.36-7.55-.51a40.13,40.13,0,0,1-6.38-.57,30.09,30.09,0,0,1,3.09-3.39l3.09-3.11Z" transform="translate(0 0)"/><path id="path5558" class="cls-5" d="M469.2,120.43c2.85.06,14.06,1,16.56,1.49,5.09.92,6.09,1.22,7.75,2.31a10.4,10.4,0,0,1,2.38,2.16,75.44,75.44,0,0,1,3.67,12.11c0,.87-1.51.87-8,0-7.2-1-11-2.78-15.06-7.13-2.89-3.07-8.33-10.52-8-10.89h.2Z" transform="translate(0 0)"/><path id="path5524" class="cls-6" d="M485.83,144c9.17,0,14.06.13,14.27.34a1.89,1.89,0,0,0,1.16.44,2,2,0,0,1,1.31.71,5.72,5.72,0,0,0,1.89,1.25l1.29.54-.14,3.28-.14,3.27h-6.59c-8.23,0-8.27,0-7.85,5.07.63,7.47,2.14,9.09,9.21,9.85,1.48.16,2.61.42,2.51.57-.53.87-10.13,4.47-14.46,5.43a22.11,22.11,0,0,0-5.1,1.49c-.13.38-8.48.21-16.87-.36-4.55-.3-4.36-.12-5-4.49-.23-1.69-1.74-8.12-3-13a84.21,84.21,0,0,0-6.2-12.29l-1.31-1.94L475.2,144Z" transform="translate(0 0)"/><path id="path5512" class="cls-6" d="M5,146.55H4.91L5,153.16V158a9.39,9.39,0,0,1,0,1.59,3.84,3.84,0,0,1,0,.48.67.67,0,0,1,0,.2,1,1,0,0,1-.5.32,2.7,2.7,0,0,1-.85.14H2.27l.24,4c.19,3.13.62,5.21,1.67,6.82s2.74,2.72,5.4,3.93a34.59,34.59,0,0,0,9,2.33c1.63.26,3.14.48,4.25.6.55.07,1,.11,1.33.13h.57v-.07a.11.11,0,0,0,0-.08v-16l-.07-15.74h0l-9.84-.12L5,146.45Z" transform="translate(0 0)"/><path id="path5674" class="cls-6" d="M502.12,155h-2.87l-7.3.12a.36.36,0,0,0-.36.36h0V159a16,16,0,0,0,.65,5.29,4.7,4.7,0,0,0,2.42,2.63,14.18,14.18,0,0,0,5.6,1.12,14.72,14.72,0,0,0,3.51,0,3.21,3.21,0,0,0,1.72-1.22,4.35,4.35,0,0,0,1.16-2,26.48,26.48,0,0,0,.55-4.16c.11-1.28.17-2.49.18-3.4v-1.52a.56.56,0,0,0-.48-.51l-.34,0-1-.08c-.85,0-2-.07-3.36-.07Z" transform="translate(0 0)"/><path id="path5704" class="cls-2" d="M5.66,111.83v4.76H16.74l.08-2a21.5,21.5,0,0,0-.68-2.74Z" transform="translate(0 0)"/><path id="path5702" class="cls-2" d="M5.66,117.81v6.67H16.4l.26-6.67Z" transform="translate(0 0)"/><path id="path5687" class="cls-2" d="M5.66,125.73v6.9l9.16.26c1,0,1.33-1.06,1.35-1.62l.23-5.54Z" transform="translate(0 0)"/><path id="path5728" class="cls-6" d="M137.41,147.15H381.27c3.09-.55,2.84-2.14,3.26-3.57H134.74C135.17,144.93,135.16,146.36,137.41,147.15Z" transform="translate(0 0)"/><circle id="path4706" class="cls-7" cx="103.85" cy="173.16" r="5.25"/><circle id="path4713" class="cls-8" cx="103.99" cy="173.35" r="31.77"/><circle id="circle4715" class="cls-8" cx="103.99" cy="173.35" r="20.4"/><circle id="circle4717" class="cls-9" cx="103.99" cy="173.35" r="5.6"/><circle id="circle4719" class="cls-7" cx="423.35" cy="173.16" r="5.25"/><circle id="circle4721" class="cls-10" cx="423.49" cy="173.35" r="31.77"/><circle id="circle4723" class="cls-8" cx="423.49" cy="173.35" r="20.4"/><circle id="circle4725" class="cls-9" cx="423.49" cy="173.35" r="5.6"/><path id="rect5685" class="cls-6" d="M71.59,148.12H28.06v-5H74.28C73.84,145,73.86,147,71.59,148.12Z" transform="translate(0 0)"/><path class="cls-5" d="M441,77.14a253.62,253.62,0,0,0-18-20.09c-1.55-1.55-7.76-7.36-20.17-19-2.29-2.14-5.63-5.26-10.08-9.34-3.66-3.36-6.75-6.15-9-8.15l-11.1.77L410.2,59a17.8,17.8,0,0,0,2.4,1.2c1.37.55,1.89.56,2.51,1.14.27.26.55.62,1.14,2.29a31.76,31.76,0,0,1,1,3.33l-.44-.82,14,14.95,1.59-1.29,9.92-.49.17-.42-2.85-3.51" transform="translate(0 0)"/><path id="path4670" d="M50,0C33.61,0,32.47.06,30.41.87a15.61,15.61,0,0,1-6.17.86c-7,0-11,1.65-13,5.42-.44.82-1,1.48-1.31,1.48-.73,0-1,.94-.47,1.9.28.55.26,2.07-.06,4.53-.26,2-.67,6.42-.92,9.74s-.63,8-.86,10.35C7,40.6,6,54.57,5.42,63.83c-.25,3.91-.77,11.29-1.16,16.39-.57,7.39-.72,15.61-.75,40.54,0,17.19.13,32.93.32,35l.34,3.71-1.69.27a4.47,4.47,0,0,0-2.18.87c-.67.8-.13,8,.62,8.32a.81.81,0,0,1,.32,1C.78,171.72,4.64,176,6.73,176A14.29,14.29,0,0,1,10,177.12a37.42,37.42,0,0,0,7.87,1.94c7,1.07,7.81,1.06,7.81-.06,0-.85.16-.86,5.93-.54,3.26.19,12,.34,19.3.34,12.69,0,13.43,0,14.55-.86s2.29-3.64,3.34-8.74c.55-2.66.58-2.69,2-2.69,1.66,0,1.68.07,1,4.23-.72,4.46.4,11.06,2.74,16.09a34.8,34.8,0,0,0,10.67,13l3,2.09,15.9-.12,15.9-.13,2.63-1.73c6.37-4.18,12-13.22,13.2-21.34a28,28,0,0,0,.41-5.71l-.22-1.62h3.86l.26,2c.39,2.81,1.4,4.48,3.22,5.31,1.46.66,5.11.71,42.89.63l41.29-.08v4.27l29.86-.11,29.86-.11.14-2,.13-2.05h98.3l.45-1.18a25.57,25.57,0,0,0,.86-3.34c.66-3.51.66-3.52,2.33-3.32,1.34.15,1.51.32,1.51,1.42,0,.69.3,3.24.66,5.66,1.32,8.76,6.43,17.17,13.09,21.53L408,202h15.27c8.45,0,15.79-.2,16.32-.41,4.32-1.74,10.41-8.28,13.13-14.11,1.94-4.13,3.52-11.41,3.08-14.13l-.25-1.51h4.29l.54,2.4c.4,1.8.77,2.49,1.5,2.76,1.58.61,21.27,1.08,21.93.53a23.59,23.59,0,0,1,4.86-1.37c6.13-1.29,14-4.77,16.08-7.12a9.91,9.91,0,0,1,2.28-2c.73-.27,1.25-4.26,1.25-9.62,0-2.32-.12-2.72-.87-2.91s-.86-.59-.86-2.83.12-2.63.89-2.88c1.43-.45.78-1.59-1.32-2.29-1.07-.36-1.7-.73-1.4-.83.84-.28.63-2-.35-2.93l-.91-1,1-.35c.84-.31.91-.56.67-2.39a12.51,12.51,0,0,1,.35-4.35,5.48,5.48,0,0,0,.24-3,58.33,58.33,0,0,1-2.82-6.68c-.45-2.18-3.58-6.83-6.81-10.12-4.41-4.48-17.84-14.75-30.26-23.13-9.06-6.12-12.72-9-12.72-9.9a4.72,4.72,0,0,0-1.16-1.64A3.4,3.4,0,0,0,449,79c-1.68,0-1.92-.17-4-2.81-2.38-3-3.46-3.43-4.51-1.93-.58.82-1,.48-7.66-6.79-12.09-13.14-25.14-26.13-38.35-38.2-15.76-14.38-15.36-14.06-20.77-17a67.39,67.39,0,0,0-22.19-7.51c-17.06-2.93-26.26-3.35-71.36-3.28-17,0-32.92.05-35.47,0H227c-7.18,0-15.86-.05-19.3-.13-8.22-.21-54.58-.21-62.31,0-3.33.09-19.24.13-35.37.09s-31.26,0-33.63.16c-3.71.19-4.64.1-6.6-.68C67.56,0,66.74,0,50,0ZM59,1.41c5.06.07,1,.12-8.92.12S36,1.48,40.84,1.41h9C53.13,1.41,56.4,1.37,59,1.41ZM241.2,3.9h36.58c44.4,0,56.34.54,67.86,3.06,5.52,1.21,11.87,3.2,14.23,4.48,2.16,1.16,2.07,1.28-.56.66s-13.45-1.65-24.92-2.37c-7.37-.48-19.61-.63-51-.64-22,0-40.16-.14-41.35-.32h0l-3.78.05c-.34.23-11.55.27-28,.1-15.3-.16-36.51-.29-47.15-.29H143.83V4.46l34.37-.29c18.9-.15,40.36-.28,47.7-.28h15.3ZM142.53,6.26V8.63H76.12V3.89h66.41Zm-67.7,0V8.62l-24.69.12c-13.58.06-27.75.16-31.5.22-6.37.1-6.78,0-6.4-.65,1-1.82,2.94-3.11,5.67-3.75C20.26,4,25,3.9,47.77,3.89H74.83Zm263.92-2.1c2,.12,7.16.8,11.43,1.51a65.37,65.37,0,0,1,22.13,7.27c4.39,2.25,9.89,6.11,10,7,0,.49-2.12.64-6,.43l-3.67-.19L370.2,18a12.68,12.68,0,0,1-2.48-2.69c-.13-1.34-7.41-5.31-13.2-7.2A107.48,107.48,0,0,0,339,4.53L335.12,4ZM250,10.41c4.81-.05,12.54-.05,25.19-.05h33V51.73c0,16.4-.08,30.53-.18,37.22h0V94.8h.1v22.06h-67.2l-2,.06h-.06l-18.32-.19-19.08-.07-.12-10.93-.08-10.89h0V93.13h0V10.33h31.35l17.4-.09Zm67.78-.05c14.35,0,35.51,1.61,43.19,3.27a8.52,8.52,0,0,1,5.17,2.72c1.21,1.13,4.62,4.28,7.57,7,6.89,6.31,13.74,13.07,24.46,24.11,9.5,9.8,11.64,12.31,10.81,12.63-.29.11-2.45-1.86-4.79-4.38s-9.72-10.07-16.39-16.79c-11-11-12.43-12.35-15.17-13.68a31.62,31.62,0,0,0-6-2.1c-4.68-1-18.41-1.68-34-1.73H318.31l-.58,1.08c-.48.89-.54,7.62-.33,38.81.13,20.76.36,41.77.51,46.69l.27,8.94H309.4V10.36ZM200.32,51.73v38.1h0v12.51h0v14.1H115.46c-76.11,0-85,.07-85.82.67s-1,1-1,4.07c0,2.51.18,3.57.68,4.07s9,.68,85.82.68h85.14v17.25H167.4c-22.69,0-33,.14-33.24.46-.45.72.12,2.31,1.27,3.56l1.07,1.16h63.87v23.72l-29.6-.08-29.57-.11-1-3.67c-2.24-8.61-5.09-15.74-8-19.94a25.36,25.36,0,0,0-17.3-10.18c-10.82-1.5-22.16-.73-29.07,2a15.93,15.93,0,0,0-6.59,4.16c-4.9,4.78-9.42,14.42-11.73,25.06a6,6,0,0,1-1.18,2.7c-.86.64-4,.66-22.81.11-7.62-.23-14.65-.54-15.63-.69l-1.77-.29V102.34h0V89.83h0V10.36h174.2ZM25.2,29.17V48l-2.91-.26c-1.6-.15-5.29-.4-8.19-.55a28.39,28.39,0,0,1-5.28-.53c0-.15.3-3.85.66-8.24s.83-10.41,1-13.37.65-7.48.93-10L12,10.43H25.2ZM395,31.37c15.25,13.87,44,43.46,44,45.33,0,.39.2.72.43.72a2.35,2.35,0,0,1,1,.35c1.32.84.26,1.15-3.9,1.15-3.3,0-4.66.17-5.29.65-.92.72-.94.7-10.15-9.37-3.31-3.62-3.84-4.4-3.84-5.72,0-2.2-2.19-4.5-4.6-4.82-1.62-.22-2.18-.67-5.92-4.83-5-5.51-23-23.79-28.84-29.3l-4.22-4h10.6Zm-60.8-8.64c16.42,0,28,.65,32.52,1.71,6.11,1.41,7,2.06,20.82,16C407,60,408.16,61.44,407,63.34c-.25.4-1.33-.52-3.77-3.23C396.63,52.86,377.86,33.44,375,31c-5.47-4.72-11-5.65-33.72-5.69H326.4l-1.57,1.08c-3.21,2.19-3.43,4.74-2,23.29,2.29,30.47,3,33,9.88,36.44,5,2.53,13.06,4.4,41.46,9.71l29.51,5.52,10.78,2,.12,6.79.12,6.78H319.4l-.32-8.08c-.18-4.45-.35-25.65-.37-47.12v-39Zm-94.66,2.59v.17H226.27c-15.21,0-16.54.2-19.11,2.9a8.14,8.14,0,0,0-1.83,2.8c-.47,2-.34,42,.14,43.8a7.79,7.79,0,0,0,1.85,3c2.62,2.54,3.72,2.7,18.71,2.7h42.75c30.83,0,30.87,0,33.63-2.68a7.84,7.84,0,0,0,1.84-2.9c.57-2,.57-42,0-44a8.81,8.81,0,0,0-5.69-5.1c-1.4-.34-10.62-.49-29.86-.49H240.86v-.18Zm-153.83.17c-55.62,0-51.71.19-53.89,2.92s-2.29,3-2.29,24.64c0,22.44.06,22.91,2.68,25.07,3.34,2.75-2.23,2.57,81.35,2.52,65,0,76.43-.14,77.9-.67a8.16,8.16,0,0,0,4.9-4.85c.68-2.29.68-42,0-44.07a9.4,9.4,0,0,0-1.78-2.83c-2.74-2.91,2.57-2.73-81.19-2.73Zm247.3.57c.42.1.08.19-.75.19s-1.17-.09-.76-.19a3.22,3.22,0,0,1,.76-.09,3,3,0,0,1,.74,0Zm-87.63.67H268.7c15.36,0,28.67.19,29.59.4a6.85,6.85,0,0,1,5,5.25c.34,1.47.5,8.14.5,20.65s-.16,19.18-.5,20.65a6.86,6.86,0,0,1-4.68,5.15c-.91.26-12.58.44-29.65.47H226c-8.93,0-14-.17-15-.49a7.12,7.12,0,0,1-4.68-5.2c-.61-2.85-.61-38.39,0-41.24a7.12,7.12,0,0,1,4.68-5.2q1.5-.48,15-.49H245.4Zm81.21.47a5.49,5.49,0,0,0-2.11,2.19c-1,1.69-1,2-.71,7.64.56,11.06,3,30.73,4.36,35.17.87,2.83,2.23,4.74,4.09,5.77,2.92,1.62,11,3,23.51,4.16,23,2.06,37.56,3.2,47.44,3.71,5.45.29,10,.64,10.21.78a61.06,61.06,0,0,1,.6,7.88l.31,7.63-1.68-.38c-.92-.2-12.25-2.33-25.18-4.73-46.59-8.64-53.35-10.3-57.5-14.17-2.67-2.48-3.61-6.17-4.79-18.82-1.86-20-2.41-32.62-1.48-34.42.84-1.64,2.22-2.89,3.15-2.85s.77.11-.19.46ZM65.2,27.08c12.16,0,28.35,0,49.17.08l77.71.21,1.46,1.42C195.87,31.05,196,32.36,196,53s-.14,22-2.47,24.24l-1.43,1.46-77.5.22c-46.38.12-78,0-78.78-.19a10.56,10.56,0,0,1-2.69-1.44,5.29,5.29,0,0,1-1.85-2.72c-.29-1.07-.4-9-.33-22.34L31,31.55l1.35-1.85a5.7,5.7,0,0,1,2.8-2.3c.68-.21,9.77-.32,30-.33Zm270.23.55c2.57,0,5.9,0,10.22.12,14.51.27,23.37,1,24.21,1.87.18.2,1.52,11.31,3,24.69l2.57,24.34-1.83,1.86a22.57,22.57,0,0,1-1.93,1.86L357.4,81.1c-14.37-1.3-21.75-2.55-24.59-4.18s-3.85-4.54-5.08-13.3c-1.3-9.25-2.39-19.92-2.66-26.13-.24-5.62-.19-6.44.51-7.62,1-1.72,2-2.23,9.77-2.24ZM372.78,31c.29,0,.86.42,2.11,1.43,2.7,2.19,26.85,27.45,26.85,28.08a3.89,3.89,0,0,0,1.05,1.54c.94,1,1.13,1.8,1.73,7.52.7,6.68.87,11.91.39,11.91a10.66,10.66,0,0,1-2.05-1.41c-2.68-2.14-5.33-3.76-6.15-3.76a3.38,3.38,0,0,0-1.73.93l-1,.94-2.78-2.64c-1.53-1.47-3.12-2.66-3.54-2.66s.93-1.72,4.06-4.9c2.65-2.69,4.83-5.11,4.83-5.39a3.81,3.81,0,0,0-2.24-2.22c-.29,0-4.25,3.72-8.81,8.26l-8.3,8.25L377,75.43c-.54-3.25-4.61-43.18-4.48-44,0-.28.11-.44.28-.44ZM9.64,48.09A124.47,124.47,0,0,1,22.29,49l2,.26.14,3,.15,2.94L22,55.43c-1.42.13-4.24.4-6.25.62a51.14,51.14,0,0,1-5.39.34L8.6,56.33,8.5,52.4c-.11-3.27,0-4,.56-4.2a2.76,2.76,0,0,1,.57-.06ZM25.2,74.82V92.38h0v2.94h0v23.21c0,13-.12,23.77-.28,23.93a84.53,84.53,0,0,1-9.68.29c-9.07,0-9.39,0-9.66-.88-.38-1.18.21-7.39.75-8.07.31-.38,1.78-.52,4.93-.47,3.47.06,4.65-.07,5.14-.57S17,130.36,17,122c0-10.17-.19-11.76-1.7-14.2a85.25,85.25,0,0,0-7-8.41c-1.63-1.72-2-2.32-1.83-3.23h0l.07-4.4h0c-.2-3.72.11-15.23.7-23.41.41-5.69.78-10.4.83-10.45s13.67-1.41,15.41-1.41H25.2ZM414.8,62.07c1.12,1.17,1.22,1.57,1.43,5.76a48.81,48.81,0,0,1-1.43,14.09c-.72,2.76-.86,2.93-2.55,3.12-2.15.23-3.67-.13-4.13-1-.6-1.13,1.37-20.74,2.26-22.48a1.66,1.66,0,0,1,1.6-.79,4.17,4.17,0,0,1,2.85,1.3ZM409,61.7a1.52,1.52,0,0,1-.1.47,31.93,31.93,0,0,0-.52,3.77,11.89,11.89,0,0,1-.52,3.07,11.72,11.72,0,0,1,.09-3.13,13.93,13.93,0,0,1,.74-3.77c.21-.28.31-.42.34-.41Zm-14.43.15a.53.53,0,0,1,.32.08c.44.28.06,1-.53,1a.38.38,0,0,1-.4-.36h0a.72.72,0,0,1,.61-.76Zm-1.33,1.81h.12c.6.34-.63,1.73-7.35,8.27-5.71,5.56-8.2,7.72-8.52,7.39s1.81-2.73,7.34-8.26c6-6,7.72-7.54,8.41-7.44Zm12.28.81c.12,0,.3.18.57.42.7.63.81,1.13.62,2.77-.5,4.14-.8,4.06-1.2-.35-.19-2.18-.25-2.87,0-2.84Zm15,6.78c1.47,1.59,5.07,5.52,8,8.73l5.32,5.84h-7.35l-4.6-5.28c-4.1-4.69-4.58-5.41-4.36-6.52a24.92,24.92,0,0,0,.26-3.45V68.36ZM407.58,70h0a23.88,23.88,0,0,1-.23,5.14c-.27,2.68-.52,5.61-.55,6.51s-.22,1.47-.41,1.27-.08-2.78.27-5.73.64-5.84.65-6.41.1-.83.22-.81ZM387,74a13.29,13.29,0,0,1,3.82,2.65L393.3,79,391,81.41l-2.34,2.4L385,83.54c-2-.14-4.49-.38-5.5-.52s-1.83-.45-1.83-.7a32.5,32.5,0,0,1,4-4.53c3-3,3.85-3.82,4.69-3.86a2.72,2.72,0,0,1,.57,0Zm30.3,3.3a93.18,93.18,0,0,1,6.4,7.36c.53.76.39.8-2.64.8a32.83,32.83,0,0,1-4.54-.26c-1.07-.22-1.26-.41-1-1a23.2,23.2,0,0,0,1-3.83,10.73,10.73,0,0,1,.8-3.1Zm-17.49,2.14c5.26,3.66,7.2,5.92,4.68,5.44-.66-.13-4-.36-7.55-.52a37.67,37.67,0,0,1-6.36-.55,30.88,30.88,0,0,1,3.09-3.38l3.09-3.11Zm45-1.57a.19.19,0,0,1,.15,0,.93.93,0,0,1,.43.67c0,.62-.31.48-.6-.26-.11-.29-.1-.46,0-.46Zm3.68,2.42c2,0,2.15.06,1.43.59s-.68.71,1.27,2.8,2,2.21,1,2.21c-.74,0-1.81-.77-3.5-2.55a21.67,21.67,0,0,1-2.44-2.8,5.18,5.18,0,0,1,2.24-.3Zm-11.74,0h7.62l2.48,2.8,2.47,2.8H438l-2.07-2.2c-2.93-3.13-3.41-3.39.73-3.4Zm-61.16.43c.54,0,.44,1-.15,1.64s-.94.64-1.35.23.92-1.92,1.5-1.92ZM426.27,87l11.11.3,6.16,3.63a332.72,332.72,0,0,1,29.56,19.62c3.28,2.57,5.7,4.67,5.39,4.67s-2.22-.4-4.24-.89c-4.76-1.14-38.67-8-49.86-10.13l-8.67-1.63-.32-5.19c-.16-2.84-.28-6.42-.28-7.94V86.62ZM461,94.12c13.48,9,21.1,14.66,26.62,19.76,4.55,4.21,6.13,6.11,4.54,5.45-.44-.19-2.1-.79-3.68-1.34a43.17,43.17,0,0,0-4.34-1.27q-1.46-.27-8.55-5.85A327.05,327.05,0,0,0,445,90.35l-5.38-3.16h11Zm-5.29-6.87c1.49,0,2.74.86,10.72,6.31,18.72,12.8,30.42,22.44,33.33,27.49a18,18,0,0,1,1.66,4l.41,1.82h-2.16c-2.07,0-2.08,0-2.72-1.91-2.78-8.15-11.18-15.74-35-31.55l-9-6,2-.13h.66ZM334.57,91.88c-2.92,0-3.42.12-4.47,1.1A3.71,3.71,0,0,0,329,94.7c0,.45-.49.63-1.68.63-1.81,0-2.2.46-2.2,2.58,0,1.3.63,1.73,2.53,1.73.89,0,1.27.3,1.65,1.29.65,1.72,2,2.16,6.57,2.16,3.19,0,4-.14,4.93-.89.63-.49,1.14-1.14,1.14-1.45s1.18-.62,4.08-.79a26.53,26.53,0,0,0,4.53-.52c.63-.4.56-3.67-.1-3.89a39.45,39.45,0,0,0-4.35-.36c-3.68-.18-3.83-.23-4.59-1.47-.91-1.51-2.15-1.84-6.85-1.84Zm-.09,1.19h1c3.65.11,5.1.56,5.1,1.61,0,.52-.91.63-5.17.63-2.85,0-5.18-.16-5.18-.36a2.78,2.78,0,0,1,.89-1.17c.65-.59,1.3-.75,3.38-.73Zm10.29,3.13c3.64,0,4.85.32,4.85,1.27,0,1.19-.39,1.31-4.17,1.31h-3.59V96.19Zm-4.21,1.29c0,.81-.28.86-5,.86s-5,0-5-.86.29-.86,5-.86,4.91,0,4.91.84Zm-10.78,0c0,.72-.29.86-1.72.86s-1.73-.14-1.73-.86.29-.86,1.73-.86,1.63.1,1.63.84ZM5.07,98.14a3.9,3.9,0,0,1,.2,2c-.07,1-.18,8.92-.23,17.58-.06,10.16-.22,15-.46,13.8s-.25-9.07-.11-17.78S4.89,98,5.07,98.1ZM7.26,99.9c2.41,2.17,8.14,9.65,8.14,10.63,0,.18-2,.33-4.52.33H6.26V99.06Zm328.13-.26c4.11,0,5.17.13,5.17.6,0,1.43-2,2-6.44,1.78-2.06-.1-2.92-.33-3.34-.91a2.92,2.92,0,0,1-.58-1.1c0-.21,2.34-.37,5.19-.37Zm131.53,19.59c-6.85-.46-15.77-.9-33.89-1.72l-17-.74-.28-3.85c-.47-6.63-.36-8.9.4-8.9l.12,0c3.19,0,63.94,12.5,65.09,13.4a7.89,7.89,0,0,1,1.22,1.66c.94,1.61,1.81,1.54-8.55.69-2.33-.19-4.58-.36-7.11-.52m-42.33-8.33c-3.28,0-4.48,1.22-3.55,3.63.37,1,6.28,1,7.25,0C430.13,112.69,428.29,110.9,424.59,110.9ZM15.75,114.5v2.37H6.26v-4.74h9.49ZM344,117.88c13.56.16,35,.29,47.66.29h23v6.47H319.89l-.27-2a32.08,32.08,0,0,1-.28-3.53V117.6Zm-104.43-.15h68.57v6.9h-107l.13-3.34.13-3.34,19.08-.11,16.08-.1h3Zm253.35,3.63c1.7,1.29,2.11,2.46.49,1.4a21.72,21.72,0,0,0-4.92-1.45c-3.69-.73-4-.85-4.58-2.18-.37-.77-.49-1.4-.27-1.4,1.23,0,8,2.65,9.28,3.64Zm-174.71-1.63a33.17,33.17,0,0,1,.27,3.45v1.45h-9.07v-6.9h8.51Zm151.63,5.54,0,.1a4.44,4.44,0,0,1-2.05,0c-1.13-.14-13.26-.39-26.95-.55l-24.91-.3v-6.66l2.7.14c1.48.09,9.48.46,17.79.82,15.65.68,30.55,1.47,30.61,1.63m0,0c.06.16.66,1.12,1.42,2.38a19.36,19.36,0,0,1,1.35,2.44M200.32,121.2v3H115.2c-46.83,0-85.21-.14-85.3-.32a16.7,16.7,0,0,1,0-3l.17-2.69H200.32ZM16,120a11,11,0,0,1,0,3.24l-.27,1.47H6.26v-3.24h0v-3.23h9.38Zm453.32.63c2.86.06,14.06,1,16.56,1.49,5.1.92,6.1,1.21,7.75,2.31a10.21,10.21,0,0,1,2.39,2.15,76.43,76.43,0,0,1,3.66,12.11c0,.88-1.5.88-8,0-7.2-1-11-2.77-15.07-7.12-2.89-3.07-8.33-10.53-8-10.89a.37.37,0,0,1,.21,0Zm1.23,5.69,1.51,1.86c4.44,5.46,6.62,7.34,10.71,9.25a31,31,0,0,0,4.63,1.88.69.69,0,0,1,.62.75,10.2,10.2,0,0,0,.27,1.73l.26,1H469.2c-13.71,0-19.53-.15-20.2-.5-.51-.27-2.59-1.7-4.62-3.17a24.13,24.13,0,0,0-8.18-4.06c-4.33-1.39-4.81-1.45-12.25-1.57-4.26-.07-7.92-.3-8.14-.52a9.37,9.37,0,0,1-.09-3.73l.32-3.34,27.25.16,27.23.26m-151.83,1c.19,1.26,1.12,14,1.12,15.31,0,.4-1.33.54-5.18.54h-5.14V125.93h9Zm-10.53,7.22v8.63h-107V125.93h107ZM15.71,128.84a10.64,10.64,0,0,1-.29,3.23,21.6,21.6,0,0,1-4.75.29H6.22v-6.47h9.49ZM334,126h33.48l47.34.11-5.35,1.45a27.12,27.12,0,0,0-8.94,3.67c-7.06,4.4-12.89,12.14-16.47,21.87a118.71,118.71,0,0,0-4.56,15.9c-.59,3.75,1.46,3.49-27.5,3.49-14.08,0-26.2-.12-26.92-.26-1-.2-1.39-.56-1.57-1.4-.31-1.48-2-19.22-2-21.07v-1.42h30.76c29.93,0,30.78,0,31.66-.84s1.66-3.15,1.2-3.89c-.18-.29-10.85-.44-32.13-.44h-31.8l-.24-2.26c-.45-4.16-1.14-14.68-1-14.84s5.41-.07,14-.08Zm80.18,1.66c.38,0,.54.88.54,3,0,2.48-.13,3-.76,3.21-6.74,1.94-7.36,2.21-10.67,4.62-6.15,4.49-10.88,11.78-13.75,21.19-1,3.42-3.22,12.59-3.9,16.4l-.29,1.62H309.4v-4.3h34.2c18.8,0,34.61-.13,35.14-.28a2.38,2.38,0,0,0,1.38-1.82c.22-.86,1-4.09,1.78-7.18,5-20.11,13.8-31.58,27.14-35.2,2.49-.68,4.77-1.23,5.07-1.23Zm85.88.43c1,0,1.77.23,1.88.53s.65,2.93,1.19,5.85l1,5.3-.92.65c-1.16.81-1.18,1.54-.07,2.54,1.75,1.59.68,2-1.57.68a8.1,8.1,0,0,0-2.59-1c-1-.11-1.23-.35-1.23-1.22s.17-1.06,1.33-.94c2.29.23,2.39-.48.79-6.17-.81-2.85-1.46-5.42-1.47-5.72s.62-.53,1.68-.53Zm4.11,3.21a3.33,3.33,0,0,1,.36,1.86c-.3.78-.39.59-.69-1.41l-.26-1.72Zm-78,3.27a22.64,22.64,0,0,1,9.29,1.44,25.45,25.45,0,0,1,9,4.52,33.64,33.64,0,0,0,4.76,3.08c.25,0,.46.32.46.71a9.34,9.34,0,0,0,1.45,2.91,65.84,65.84,0,0,1,5.26,10.27l.58,1.63h-4.09l-2.66-4A29.77,29.77,0,0,0,436.82,144c-11.17-4.92-22.64-3.65-32.8,3.63-3.35,2.4-7.85,7.5-9,10.26-.51,1.18-1.46,1.49-2.9.93-1-.4-.85-1.26,1.33-6a35.13,35.13,0,0,1,10.39-13.3,19.23,19.23,0,0,1,7.41-3.73,41.14,41.14,0,0,1,5-1.27h9.85Zm-322,3.88c6.49,0,12.43.76,16.68,2.35a25.09,25.09,0,0,1,12.42,11.37l.7,1.35H131.8c-1.84,0-2.27-.17-3.13-1.26a37.4,37.4,0,0,0-4.22-3.84,32.15,32.15,0,0,0-32.4-5c-4.57,1.88-10.72,6.09-12.45,8.51-1,1.36-1.28,1.52-3.13,1.53a5.63,5.63,0,0,1-2-.19,32,32,0,0,1,1.5-2.91c3.68-6.69,9.55-10.18,19.14-11.37a77,77,0,0,1,9.11-.6ZM492.52,140a27.16,27.16,0,0,1,3.7.49,1.89,1.89,0,0,1,.32,1.26c0,1.07,0,1.07-3.55,1l-3.56-.13-.14-1.44-.14-1.44Zm-69.45,2.35A32.05,32.05,0,0,1,436.2,145c12.65,5.49,20.22,19.69,17.89,33.59A31.73,31.73,0,0,1,441,199.09l-3.24,2.27H409.07l-3.56-2.55a31.22,31.22,0,0,1-10.69-37.52,30.21,30.21,0,0,1,10-12.74,31.77,31.77,0,0,1,18.33-6.28Zm-318.56,0a31.68,31.68,0,0,1,19,7.06c8.5,6.71,12.77,18.14,11,29.36a32.16,32.16,0,0,1-13.1,20.4l-3.21,2.22H104.58v-3.2c0-3.6-.39-3.24,4.31-4,5.09-.76,11.06-5.5,13.8-11,4.28-8.52,2.86-17.77-3.82-24.87a22.37,22.37,0,0,0-12.07-6.1,20.67,20.67,0,0,0-18.24,6.5C83.77,164.19,82,170,83,176.85a21.24,21.24,0,0,0,17.19,17.59l3.13.53v6.39H89.65l-3.45-2.45C74,190.14,69.62,175.3,75.28,161.38a29.49,29.49,0,0,1,10-12.85,31.34,31.34,0,0,1,19.25-6.26Zm-75.63,1.08-.43,1.22a2.52,2.52,0,0,0,.22,2.35l.65,1.16,20.69.08c13.83,0,21-.07,21.62-.38,1.24-.6,2.16-2.8,1.57-3.74-.41-.64-2.57-.71-22.38-.71Zm-17.59.34H16.2c8,.11,8.82.19,9,.87s-.53.76-9.16.76c-5.11,0-9.3-.15-9.29-.33,0-1,.47-1.3,4.59-1.33Zm372.54,1.54a3.06,3.06,0,0,1-.81,1.51c-.27.17-14.33.32-31.23.32H321.07v-3h63Zm101.67-1.14c9.18,0,14.06.13,14.27.34a1.92,1.92,0,0,0,1.2.49,2,2,0,0,1,1.31.72,6.1,6.1,0,0,0,1.89,1.25l1.29.54-.14,3.28-.14,3.27H498.6c-8.24,0-8.28,0-7.86,5.06.63,7.47,2.15,9.09,9.22,9.85,1.48.16,2.6.42,2.51.58-.54.87-10.13,4.46-14.47,5.42a21.57,21.57,0,0,0-5.09,1.5c-.14.38-8.49.2-16.87-.36-4.56-.3-4.36-.13-5-4.49-.23-1.7-1.73-8.12-3-13a84.21,84.21,0,0,0-6.2-12.29l-1.31-1.94,24.43-.11h10.59Zm-242.67.34h65.3v2.59H230.64V147H201.2v-2.59h29.46v-.07h12.19Zm71.72,0c4.28,0,5.17.12,5.39.69.7,1.83.5,1.9-5.13,1.9H309.4v-2.59Zm-114.23,1.26V147h-63.8l-.67-1.29-.67-1.3h65.14Zm-149.46-1.3c18.24,0,21.38.09,21.38.62a2.35,2.35,0,0,1-.68,1.3c-.61.6-3,.67-21.24.57l-20.56-.11-.14-1.19-.13-1.19ZM5,145a1.13,1.13,0,0,1,.48.08c.34.14.24.24-.26.26s-.71-.08-.57-.22A.43.43,0,0,1,5,145Zm9.74,1.81,9.85.12.06,15.73c0,8.66,0,15.86-.09,16a34.76,34.76,0,0,1-6.1-.7,34.18,34.18,0,0,1-9-2.32c-5.31-2.41-6.64-4.42-7-10.66l-.24-4H3.4a1.85,1.85,0,0,0,1.43-.52A44.53,44.53,0,0,0,5,153.34L5,146.7Zm230.86,1.62H308.1v24.11l-53.37-.11-53.36-.11-.12-12-.11-12h44.43Zm74.6.78c0,1.08,1.66,19.3,2,21.54l.24,1.83h-13v-24.2h5.39c4.93,0,5.41.07,5.41.78Zm102.94,3A20.53,20.53,0,0,0,408,158.89c-4.79,5.48-6.52,11.17-5.52,18.12a21.35,21.35,0,0,0,16.85,17.51,19.31,19.31,0,0,0,8.59-.13c10.67-2.06,18.1-13.09,16.35-24.29a22,22,0,0,0-18-17.7,21.55,21.55,0,0,0-3.21-.21ZM104,153.37a17.7,17.7,0,0,1,3,.26c16,2.75,22.49,22.33,11.25,34-3.2,3.31-8.52,5.86-12.68,6.06l-1,.05h0l-1.29.07h0l-2.48-.29c-6.22-.72-12.24-5.41-15.21-11.85-1.43-3.1-1.5-3.44-1.49-8.19s0-5.06,1.57-8.2c2.22-4.59,4.91-7.44,8.93-9.45a20.4,20.4,0,0,1,9.33-2.42Zm319.43,0a19.11,19.11,0,0,1,13.85,5.74c2.29,2.23,5.46,7.31,5.46,8.78,0,.29-.69-.92-1.54-2.69q-4.28-9-14.49-11a19.69,19.69,0,0,0-17,5.42c-2.43,2.54-5.29,7.68-5.4,9.68l-.06,1.26-.18-1.22c-.12-.79.33-2.29,1.29-4.31a18.92,18.92,0,0,1,8.89-9.32,21.52,21.52,0,0,1,9.2-2.38Zm-347,2.92a30.14,30.14,0,0,0-2.26,4.77c-1.22,3.18-1.31,3.29-2.68,3.29s-1.4-.07-1.13-1.19c.15-.65.9-2.73,1.65-4.63l1.36-3.45,2-.13,2-.13Zm55.92-1.43c1.72,0,2,.16,2.58,1.19s4.16,11.82,4.16,12.38c0,.13-.77.23-1.72.23-1.56,0-1.73-.1-1.73-1.09,0-1.75-2.89-9.58-4.14-11.22l-1-1.48Zm291.14.24a17.71,17.71,0,0,1,2.82.26,18.42,18.42,0,0,1,15.32,20.9,19.54,19.54,0,0,1-9.4,13.56c-3.36,1.8-5.1,2.13-10.12,1.9-3.47-.15-4.35-.36-6.91-1.65a18.49,18.49,0,0,1-9.86-13.43c-2-11.22,7.2-21.63,18.15-21.54Zm78.74.27a24.64,24.64,0,0,1,4.78.25,19,19,0,0,1-.06,5c-.37,4.19-.52,4.76-1.61,5.94s-1.23,1.29-4.93,1.09a13.85,13.85,0,0,1-5.46-1.08c-2.17-1.11-2.83-2.84-2.86-7.59v-3.45l7.29-.12h2.88Zm-109.77,4.8,1.54.29-1,2.46a21.18,21.18,0,0,0-1.31,5c-.22,2-.41,2.46-.93,2.26a5.26,5.26,0,0,0-1.47-.24c-1,0-1-.35.05-5,.92-4,1.16-4.84,2.25-4.83a5.93,5.93,0,0,1,.84.06Zm65.76,3.6c.49,1.84,1,4.07,1.18,5l.28,1.62h-1.94c-1.64,0-2-.15-2.19-1a9.12,9.12,0,0,1-.27-2.08,16.1,16.1,0,0,0-1.08-3.85c-.6-1.52-1.08-2.81-1.08-2.89a8.78,8.78,0,0,1,2.11-.13h2.11Zm-34.66,4.67c-2.09,0-2.53.16-3.76,1.39s-1.39,1.66-1.37,3.74c0,1.69.25,2.6.85,3.27a5.6,5.6,0,0,0,5.8,1.68c3.77-.86,5-6.09,2.1-8.88-1.09-1-1.65-1.2-3.65-1.2Zm-319.53,0c-2.12,0-2.55.16-3.79,1.39s-1.39,1.65-1.37,3.82.17,2.55,1.41,3.65a6.44,6.44,0,0,0,1.57,1h4a7.58,7.58,0,0,0,2-1.51c1.08-1.13,1.28-1.66,1.25-3.49a4,4,0,0,0-1.4-3.51c-1.2-1.2-1.64-1.36-3.74-1.36ZM443,169c.06,0,.1.29.11.73,0,.71-.09,1.06-.2.76a2.36,2.36,0,0,1,0-1.29c0-.16.08-.22.11-.2Zm-336.09,1.8a2.8,2.8,0,0,1,1.07,3.12c-.39,2.9-3.32,4.69-3.32,2,0-.86-.21-1.29-.64-1.29s-.65.43-.65,1.29c0,1.68-1.3,1.76-2.56.16a4.22,4.22,0,0,1,3.22-6.67,4.12,4.12,0,0,1,2.83,1.39Zm316.66-1.31a3.62,3.62,0,0,1,2.89,1.31c1.15,1.15,1.28,1.53,1.08,3-.26,2-1.23,3.26-2.62,3.53a4.9,4.9,0,0,1-4.48-1.27,4.06,4.06,0,0,1,3.13-6.62Zm19.86,3.24c.71,7-4.1,15.26-10.83,18.65-3.85,1.94-5.67,2.3-10.57,2.07a14.93,14.93,0,0,1-6.95-1.53c-5.81-2.68-10.88-9.59-11.37-15.49l-.24-2.81.59,3.06a19.69,19.69,0,0,0,11.17,14.65c3.47,1.63,3.7,1.68,8.31,1.68s4.85-.06,8.24-1.65c6.84-3.22,11.15-10.13,11.45-18.36l.07-2Zm-39.66-.62c0,.83-.09,1.17-.2.76a3.5,3.5,0,0,1,0-1.51.18.18,0,0,1,.08-.18,2,2,0,0,1,.15.89Zm-375.22.59c1.38.15,10.51.39,20.29.55s17.79.36,17.79.46a8,8,0,0,1-2.26,3.37c-.88.65-2.66.69-18.22.49-9.49-.12-17.83-.39-18.54-.6-1.18-.35-1.31-.58-1.43-2.46L26,172.43Zm279.58,2.86v2.17h-107l.13-2,.14-2,53.36-.11,53.37-.11Zm-107.78.17v2H172.2c-24.2,0-28.28-.09-29.07-.64a4.73,4.73,0,0,1-1.36-1.94l-.46-1.3h59Zm85.82,4.74V182H228.78v-3h57.36Z" transform="translate(0 0)"/><rect class="cls-1" x="28.06" y="18.78" width="171.7" height="83.29"/><rect class="cls-1" x="204.02" y="20.46" width="102.38" height="73.72"/><circle class="cls-11" cx="103.85" cy="174.74" r="19.49"/><path class="cls-12" d="M103.86,142.26a32.48,32.48,0,1,0,32.48,32.48h0A32.49,32.49,0,0,0,103.86,142.26Zm0,55.21a23.55,23.55,0,0,1-22.74-22.74A22.74,22.74,0,0,1,103.86,152a21.91,21.91,0,0,1,22.73,21v1.68h0a22.73,22.73,0,0,1-22.73,22.73h0Z" transform="translate(0 0)"/><path class="cls-13" d="M103.86,152.81A21.93,21.93,0,0,0,82,174.73h0a21.93,21.93,0,0,0,21.93,21.92h0a22.73,22.73,0,0,0,21.92-21.92,21.91,21.91,0,0,0-21.89-21.93h-.07ZM85.2,170.73,95,173.16h0v3.25L85.2,178ZM99,182.91l-6.5,7.3-4.87-5.68,8.93-4.87L99,182.09Zm-2.44-13-8.15-4.11,4.87-5.68L99,167.43h0Zm4.85,22.69,2.44-9.75h2.43l2.44,9.75Zm4.87-26.8h-2.43l-2.44-9.74h7.31Zm3.25,1.63,5.69-7.31,4.87,5.68L112,169.86l-2.44-1.62Zm5.66,22.73-4.88-7.3h0l1.63-2.44,8.93,4.87Zm-2.44-13.8v-3.25h.81l9.82-2.38V178Z" transform="translate(0 0)"/><circle class="cls-11" cx="424.03" cy="175.12" r="19.49"/><path class="cls-12" d="M424,141.48A32.48,32.48,0,1,0,456.51,174h0a32.49,32.49,0,0,0-32.45-32.53h0Zm0,55.21A23.55,23.55,0,0,1,401.3,174,22.74,22.74,0,0,1,424,151.27a21.91,21.91,0,0,1,22.73,21h0V174h0a22.74,22.74,0,0,1-22.7,22.78h0Z" transform="translate(0 0)"/><path class="cls-13" d="M424,153.2a21.91,21.91,0,0,0-21.93,21.89h0A21.91,21.91,0,0,0,424,197h0A22.73,22.73,0,0,0,446,175.09a21.91,21.91,0,0,0-21.9-21.92h0ZM405.4,171.06l9.74,2.44h0v3.23l-9.74,1.64Zm13.8,12.18-6.49,7.31-4.87-5.69,8.93-4.86,2.43,2.44Zm-2.43-13-8.12-4.06,4.87-5.69,5.68,7.31h0ZM421.64,193l2.44-9.74h2.43L429,193Zm4.87-26.79h-2.43l-2.44-9.74H429Zm3.25,1.62,5.68-7.3,4.87,5.68-8.11,4.06-2.44-1.63Zm5.64,22.75-4.87-7.31h0l1.63-2.44,8.93,4.88ZM433,176.73v-3.24h.81l9.74-2.44v7.31Z" transform="translate(0 0)"/><rect x="383.19" y="57.06" width="2.52" height="29.95" transform="translate(163.54 -250.75) rotate(45)"/></svg>
<style>
    .order-input-wrapper {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 2;
    }

    .order-input {
        height: 30px;
        width: 300px;
    }

    .created-at {
        font-size: 18px;
        padding: 20px;
    }

    .created-at span {
        font-weight: 600;
    }

    .tracking {
        position: relative;
        border: 10px solid;
    }

    .tracking_addresses {
        height: 570px;
        overflow-y: scroll;
        font-size: 12px;
        background-color: #fff;
        position: absolute;
        z-index: 1;
        width: 300px;
        left: 0;
        bottom: 0;
    }

    .address {
        border-bottom: 2px solid #41362f;
        cursor: pointer;
        padding: 4px;
    }

    .address:hover,
    .address.selected {
        background-color: #8080802b;
    }

    #tracking_map {
        min-height: 600px;
        width: 100%;
    }

    .mass-status-wrapper {
        position: relative;
        z-index: 4;
        margin-bottom: 20px;
    }

    .selectmenu {
        width: 200px;
    }

    .selectmenu-value input[type="text"] {
       width: 150px;
    }

    .selectmenu-items li:last-child .selectmenu-item-action,
    .selectmenu-items li:last-child .selectmenu-item-action:hover {
        color: #41362f;
        text-decoration: none;
    }

    .selectmenu-item-action:hover {
        cursor: pointer;
    }
</style>

<script src="<?= $_gmapsSrc ?>"></script>
<script>
    require([
        "jquery",
        "domReady!"
    ], function ($) {
        const STATUS_DELIVERED = '<?= $block->getOrderDeliveredStatus(); ?>';
        const STATUS_STOREHOUSE = '<?= $block->getOrderStorehouseStatus(); ?>';

        const PIN_COLOR_SELECTED    = "#FFF";
        const PIN_COLOR_DELIVERED   = "#32CD32";
        const PIN_COLOR_PROCESSING  = "#D2042D";
        const PIN_COLOR_STOREHOUSE  = "#bababa";

        let markerDelivered     = getMarkerImage('filled', PIN_COLOR_DELIVERED);
        let markerSelected      = getMarkerImage('hole', PIN_COLOR_SELECTED);
        let markerProcessing    = getMarkerImage('filled', PIN_COLOR_PROCESSING);
        let markerStorehouse    = getMarkerImage('filled', PIN_COLOR_STOREHOUSE);

        let ordersMarkers = [], infoWindows = [];
        let map, vehicle, directionsService;

        function initializeMap(data) {
            directionsService = new google.maps.DirectionsService();

            map = new google.maps.Map(document.getElementById("tracking_map"));

            let lngs = data.addresses.map(function (order) {
                return order.position.lng;
            });
            let lats = data.addresses.map(function (order) {
                return order.position.lat;
            });
            map.fitBounds({
                west: Math.min.apply(null, lngs),
                east: Math.max.apply(null, lngs),
                north: Math.min.apply(null, lats),
                south: Math.max.apply(null, lats),
            });


            let totalCounter = 0, label = 0;
            for (let i = 0, max = 23 - 1; i < data.addresses.length; i = i + max) {
                const chunk = data.addresses.slice(i, i + max + 1);

                let origin = '', destination = '', waypoints = [];
                let j = 0;

                chunk.forEach((address, index) => {
                    if (totalCounter === 0 || totalCounter % (max + 1) !== 0) {

                        let marker = new google.maps.Marker({
                            position: address.position,
                            map,
                            label: label.toString(),
                            icon: address.status === STATUS_DELIVERED ? markerDelivered :
                                address.status === STATUS_STOREHOUSE ? markerStorehouse : markerProcessing
                        });

                        let content =
                            `<div style="font-size: 16px;">Order: #${address.order}</div>
                        <div>Customer: ${address.customer}</div>
                        <div>Address: ${address.address}</div>
                        <div>Status: ${address.status}</div>`;

                        let infoWindow = new google.maps.InfoWindow({
                            content,
                            ariaLabel: address.order,
                        });
                        marker.addListener("click", () => {
                            for (const infoWindow of infoWindows) {
                                infoWindow.close();
                            }
                            infoWindow.open({
                                anchor: marker,
                                map,
                            });
                        });

                        marker.setZIndex(label + 1);
                        ordersMarkers.push(marker);
                        infoWindows.push(infoWindow);
                        label++;
                    }

                    switch (j) {
                        case 0:
                            origin = address.position;
                            break;
                        case chunk.length - 1:
                            destination = address.position;
                            break;
                        default:
                            waypoints.push({location: address.position});
                            break;
                    }
                    j++; totalCounter++;
                });

                let request = {
                    origin,
                    destination,
                    waypoints,
                    travelMode: 'DRIVING'
                };
                directionsService.route(request, function (result, status) {
                    if (status === google.maps.DirectionsStatus.OK) {
                        let directionsRenderer = new google.maps.DirectionsRenderer({
                            map: map,
                            suppressMarkers: true
                        });
                        directionsRenderer.setDirections(result);
                    } else {
                        console.log('Route creation ERROR : ');
                        console.log(status);
                        console.log(result);
                    }
                });


            }

            if (data.vehicle) {
                let icon = {
                    url: "<?= $block->getVehicleSvgUrl(); ?>",
                    anchor: new google.maps.Point(25, 50),
                    scaledSize: new google.maps.Size(50, 50)
                }

                vehicle = new google.maps.Marker({
                    position: {
                        'lat': data.vehicle.Latitude,
                        'lng': data.vehicle.Longitude
                    },
                    map,
                    icon: icon,
                });

            }
        }



        let data = {
            addresses: <?= $block->getAddresses(); ?>,
            vehicle: <?= $block->getVehicle(); ?>
        };

        initializeMap(data);

        function getMarkerImage(type, color) {
            let types = {
                'filled'    : {
                    'pin'           : "M 12,2 C 8.1340068,2 5,5.1340068 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.8659932 -3.134007,-7 -7,-7 z",
                    'labelOrigin'   : new google.maps.Point(12,9)
                },
                'hole'      : {
                    'pin'           : "M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z",
                    'labelOrigin'   : new google.maps.Point(12,15)
                }
            }

            return {
                path: types[type].pin,
                anchor: new google.maps.Point(12,17),
                fillOpacity: 1,
                fillColor: color,
                strokeWeight: 2,
                strokeColor: "white",
                scale: 2,
                labelOrigin: types[type].labelOrigin,
            };
        }

        let addresses = $('.tracking_addresses .address');

        addresses.click(function () {
            for (let [index, marker] of ordersMarkers.entries()) {
                addresses[index].dataset.status === STATUS_DELIVERED ? marker.setIcon(markerDelivered) : marker.setIcon(markerProcessing);
                marker.setZIndex(index + 1);
            };

            ordersMarkers[$(this).data('id')].setIcon(markerSelected);
            ordersMarkers[$(this).data('id')].setZIndex(100);
        });


        $('.order-input').on('input', function () {
            ordersMarkers.forEach((marker, index) => {
                marker.setIcon(markerProcessing);
                marker.setZIndex(index + 1);
            });

            for (let address of addresses) {
                if (address.classList.contains('selected')) {
                    address.classList.remove('selected');
                    break;
                }
            }

            let value = $(this).val();
            for (let address of addresses) {
                if (address.dataset.order === value) {
                    address.classList.add('selected');
                    ordersMarkers[address.dataset.id].setIcon(markerSelected);
                    ordersMarkers[address.dataset.id].setZIndex(100);
                    break;
                }
            }
        });

        $('.selectmenu-item-action').click(function () {
            $('.selectmenu-value input[name="label"]').val($(this).text().trim());
            $('.selectmenu-value input[name="code"]').val($(this).data('status-code'));
            return false;
        });

        $('.mass-status-wrapper .mass-action').click(() => {
            let checkboxes = addresses.find('input[type=checkbox]:checked');
            let orders = [];
            for (const checkbox of checkboxes) {
                orders.push(checkbox.value);
            }
            let status = $('.selectmenu-value input[name="code"]').val();
            if (orders.length && status !== 'Select status') {
                const TEXT = `Are you sure you want to change status of this orders to ${status}?`;
                let url = '<?= $block->getStatusUrl('replacedOrders', 'replacedStatus'); ?>';
                let orderParamValue = orders.join(',');
                url = url.replace('replacedOrders', orderParamValue).replace('replacedStatus', status);
                deleteConfirm(TEXT, url, {data: {}});
            }
        });
    });
</script>
